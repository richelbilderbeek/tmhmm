---
title: "Demo"
author: "Richel J.C. Bilderbeek"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Demo}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This demo shows how to estimate the location of the amino acids in a
membrane protein. This package `tmhmm` uses the tool TMHMM to do so.
The amino acids of a membrane protein are estimated to be either
inside the cell (the cytosol side), outside of the cell (the surroundings
of the cell) or in the transmembrane part.

Load the library:

```{r}
library(tmhmm)
```

For this vignette to work, TMHMM must have been installed.
TMHMM can be installed using `install_tmhmm`, but this does
require a download link that must be requested from 
[http://www.cbs.dtu.dk/services/TMHMM](http://www.cbs.dtu.dk/services/TMHMM).

```
install_tmhmm("http://www.cbs.dtu.dk/download/D3198788-0F1D-11E9-883C-84B3B9CD16B5/")
```

The TMHMM installation is checked here, with the goal of producing a helpful
error message:

```{r}
check_tmhmm_installation()
```

We need a FASTA file to work on:

```{r}
fasta_filename <- system.file("extdata", "tmhmm.fasta", package = "tmhmm")
cat(readLines(fasta_filename), sep = "\n")
```

Estimating the locations of the amino acids:

```{r}
locatome <- run_tmhmm(fasta_filename)
cat(locatome, sep = "\n")
```

The legend of these locations:

Character|Location
---|---
`i`|Inside or cytosol-side
`o`|Outside or surroundings-side
`M`|Transmembrane